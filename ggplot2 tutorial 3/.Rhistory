#chin
polygon(c(s2+.65,s2+.75/2,s2+.1),
c(c2+1.25-sqrt(3)*.75/2,c2+1.25,c2+1.25-sqrt(3)*.75/2),
col = rgb(237/255,28/255,36/255),          # Color of polygon
#border = "darkgreen",             # Color of polygon border
lwd = 2)
#top beak
polygon(c(s2+.75,s2+.75,s2+1.25),
c(c2+2,c2+1.6,c2+1.6),
col = rgb(255/255,201/255,14/255),          # Color of polygon
#border = "darkgreen",             # Color of polygon border
lwd = 2)
#bottom beak
polygon(c(s2+.75,s2+1.25,s2+.75),
c(c2+1.6,c2+1.6,c2+1.25),
col = rgb(255/255,201/255,14/255),          # Color of polygon
#border = "darkgreen",             # Color of polygon border
lwd = 2)
plot(-4:4, -4:4, col = "black")
plot.new()
plot(-4:4, -4:4, col = "black")
# body
polygon(c(-s2,s2,s1,0,-s1),
c(c2,c2,-c1,-1,-c1),
col = rgb(255/255,127/255,39/255),          # Color of polygon
#border = "darkgreen",             # Color of polygon border
lwd = 2)
plot(-4:4, -4:4, col = "white")
# body
polygon(c(-s2,s2,s1,0,-s1),
c(c2,c2,-c1,-1,-c1),
col = rgb(255/255,127/255,39/255),          # Color of polygon
#border = "darkgreen",             # Color of polygon border
lwd = 2)
# neck
polygon(c(-s2,s2,s2),
c(c2,c2,c2+2),
col = rgb(0,0,0),          # Color of polygon
#border = "darkgreen",             # Color of polygon border
lwd = 2)
#face
polygon(c(s2,s2+.75,s2+.75,s2),
c(c2+2,c2+2,c2+1.25,c2+1.25),
col = rgb(255/255,127/255,39/255),          # Color of polygon
#border = "darkgreen",             # Color of polygon border
lwd = 2)
#top beak
polygon(c(s2+.75,s2+.75,s2+1.25),
c(c2+2,c2+1.6,c2+1.6),
col = rgb(255/255,201/255,14/255),          # Color of polygon
#border = "darkgreen",             # Color of polygon border
lwd = 2)
#bottom beak
polygon(c(s2+.75,s2+1.25,s2+.75),
c(c2+1.6,c2+1.6,c2+1.25),
col = rgb(255/255,201/255,14/255),          # Color of polygon
#border = "darkgreen",             # Color of polygon border
lwd = 2)
#lower back
polygon(c(-s2,-s1,-3*s2),
c(c2,-c1,c2),
col = rgb(181/255,230/255,29/255),          # Color of polygon
#border = "darkgreen",             # Color of polygon border
lwd = 2)
#tail
polygon(c(-s2,-3*s2,-4*s2),
c(c2,c2,2*c2),
col = rgb(34/255,177/255,76/255),          # Color of polygon
#border = "darkgreen",             # Color of polygon border
lwd = 2)
#feather1
polygon(c(-3*s2,-3.5*s2,-5*s2),
c(c2,1.5*c2,-c2),
col = rgb(128/255,0,255/255),          # Color of polygon
#border = "darkgreen",             # Color of polygon border
lwd = 2)
#feather2
polygon(c(-3*s2,-4*s2,-4*s2),
c(c2,0*c2,-c2),
col = rgb(128/255,128/255,255/255),          # Color of polygon
#border = "darkgreen",             # Color of polygon border
lwd = 2)
#feather3
polygon(c(-4*s2,-3,-3.5*s2),
c(2*c2,-0*c2,1.5*c2),
col = rgb(0,128/255,255/255),          # Color of polygon
#border = "darkgreen",             # Color of polygon border
lwd = 2)
#crown1
polygon(c(s2,s2+.75,0),
c(c2+2,c2+2,c2+2.5),
col = rgb(237/255,28/255,36/255),          # Color of polygon
#border = "darkgreen",             # Color of polygon border
lwd = 2)
#crown2
polygon(c(s2,0,0),
c(c2+2,c2+2.5,c2+1.75),
col = rgb(237/255,28/255,36/255),          # Color of polygon
#border = "darkgreen",             # Color of polygon border
lwd = 2)
#chin
polygon(c(s2+.65,s2+.75/2,s2+.1),
c(c2+1.25-sqrt(3)*.75/2,c2+1.25,c2+1.25-sqrt(3)*.75/2),
col = rgb(237/255,28/255,36/255),          # Color of polygon
#border = "darkgreen",             # Color of polygon border
lwd = 2)
library(ggplot2)
ggsave(
filename = "rooster1.jpeg",
device = jpeg(),
path = NULL,
scale = 1,
width = 10,
height = 10,
units = "in",
dpi = 600,
limitsize = TRUE
#bg = "transparent"
)
png("rooster_col.jpg")
plot.new()
plot(-4:4, -4:4, col = "white")
# body
polygon(c(-s2,s2,s1,0,-s1),
c(c2,c2,-c1,-1,-c1),
col = rgb(255/255,127/255,39/255),          # Color of polygon
#border = "darkgreen",             # Color of polygon border
lwd = 2)
# neck
polygon(c(-s2,s2,s2),
c(c2,c2,c2+2),
col = rgb(0,0,0),          # Color of polygon
#border = "darkgreen",             # Color of polygon border
lwd = 2)
#face
polygon(c(s2,s2+.75,s2+.75,s2),
c(c2+2,c2+2,c2+1.25,c2+1.25),
col = rgb(255/255,127/255,39/255),          # Color of polygon
#border = "darkgreen",             # Color of polygon border
lwd = 2)
#top beak
polygon(c(s2+.75,s2+.75,s2+1.25),
c(c2+2,c2+1.6,c2+1.6),
col = rgb(255/255,201/255,14/255),          # Color of polygon
#border = "darkgreen",             # Color of polygon border
lwd = 2)
#bottom beak
polygon(c(s2+.75,s2+1.25,s2+.75),
c(c2+1.6,c2+1.6,c2+1.25),
col = rgb(255/255,201/255,14/255),          # Color of polygon
#border = "darkgreen",             # Color of polygon border
lwd = 2)
#lower back
polygon(c(-s2,-s1,-3*s2),
c(c2,-c1,c2),
col = rgb(181/255,230/255,29/255),          # Color of polygon
#border = "darkgreen",             # Color of polygon border
lwd = 2)
#tail
polygon(c(-s2,-3*s2,-4*s2),
c(c2,c2,2*c2),
col = rgb(34/255,177/255,76/255),          # Color of polygon
#border = "darkgreen",             # Color of polygon border
lwd = 2)
#feather1
polygon(c(-3*s2,-3.5*s2,-5*s2),
c(c2,1.5*c2,-c2),
col = rgb(128/255,0,255/255),          # Color of polygon
#border = "darkgreen",             # Color of polygon border
lwd = 2)
#feather2
polygon(c(-3*s2,-4*s2,-4*s2),
c(c2,0*c2,-c2),
col = rgb(128/255,128/255,255/255),          # Color of polygon
#border = "darkgreen",             # Color of polygon border
lwd = 2)
#feather3
polygon(c(-4*s2,-3,-3.5*s2),
c(2*c2,-0*c2,1.5*c2),
col = rgb(0,128/255,255/255),          # Color of polygon
#border = "darkgreen",             # Color of polygon border
lwd = 2)
#crown1
polygon(c(s2,s2+.75,0),
c(c2+2,c2+2,c2+2.5),
col = rgb(237/255,28/255,36/255),          # Color of polygon
#border = "darkgreen",             # Color of polygon border
lwd = 2)
#crown2
polygon(c(s2,0,0),
c(c2+2,c2+2.5,c2+1.75),
col = rgb(237/255,28/255,36/255),          # Color of polygon
#border = "darkgreen",             # Color of polygon border
lwd = 2)
#chin
polygon(c(s2+.65,s2+.75/2,s2+.1),
c(c2+1.25-sqrt(3)*.75/2,c2+1.25,c2+1.25-sqrt(3)*.75/2),
col = rgb(237/255,28/255,36/255),          # Color of polygon
#border = "darkgreen",             # Color of polygon border
lwd = 2)
dev.off()
setwd("~/GitHub/cv")
setwd("~/R/Blog post/ggplot2 tutorial 3")
library(ggplot2)
library(tidyverse)
cereal <- read.csv("C:/Users/amalasi/Documents/R/Blog post/ggplot2 tutorial 3/cereal.csv")
summary(cereal)
str(cereal)
# create tables
manufact <- count(cereal,mfr)
manufact <- manufact %>% mutate(perc=round(n*100/sum(n),1))
View(manufact)
# create table for manufacturer variable
manufact <- count(cereal,mfr)
# calculate the percentage share of manufacturer
manufact <- manufact %>% mutate(perc=round(n*100/sum(n),1))
manufact <- manufact %>%
arrange(desc(mfr)) %>%
mutate(y_pos = cumsum(perc)-0.5*perc)
# calculating the cumulative for positioning the text
manufact <- manufact %>%
arrange(desc(mfr)) %>%
mutate(y_pos = cumsum(perc)-0.5*perc)
# pie chart and bar plots
manufact %>% ggplot(aes(x="",perc, fill=mfr, alpha =.5)) +
geom_bar(width=1,stat="identity",color="white") +
coord_polar("y", start=0)+
geom_text(aes(y = y_pos, label = paste0(perc,"%")), color = "black")+
scale_fill_manual(values = rainbow(7)) +
theme_void()
# pie chart and bar plots
manufact %>% ggplot(aes(x="",perc, fill=mfr)) +
geom_bar(width=1,stat="identity",color="white",alpha=.5) +
coord_polar("y", start=0)+
geom_text(aes(y = y_pos, label = paste0(perc,"%")), color = "black")+
scale_fill_manual(values = rainbow(7)) +
theme_void()
# calculating the cumulative for positioning the text
manufact <- manufact %>%
arrange(desc(mfr)) %>%
mutate(y_pos = cumsum(perc)-0.45*perc)
# pie chart and bar plots
manufact %>% ggplot(aes(x="",perc, fill=mfr)) +
geom_bar(width=1,stat="identity",color="white",alpha=.5) +
coord_polar("y", start=0)+
geom_text(aes(y = y_pos, label = paste0(perc,"%")), color = "black")+
scale_fill_manual(values = rainbow(7)) +
theme_void()
# calculating the cumulative for positioning the text
manufact <- manufact %>%
arrange(desc(mfr)) %>%
mutate(y_pos = cumsum(perc)-0.4*perc)
# pie chart and bar plots
manufact %>% ggplot(aes(x="",perc, fill=mfr)) +
geom_bar(width=1,stat="identity",color="white",alpha=.5) +
coord_polar("y", start=0)+
geom_text(aes(y = y_pos, label = paste0(perc,"%")), color = "black")+
scale_fill_manual(values = rainbow(7)) +
theme_void()
# calculating the cumulative for positioning the text
manufact <- manufact %>%
arrange(desc(mfr)) %>%
mutate(y_pos = cumsum(perc)-0.6*perc)
# pie chart and bar plots
manufact %>% ggplot(aes(x="",perc, fill=mfr)) +
geom_bar(width=1,stat="identity",color="white",alpha=.5) +
coord_polar("y", start=0)+
geom_text(aes(y = y_pos, label = paste0(perc,"%")), color = "black")+
scale_fill_manual(values = rainbow(7)) +
theme_void()
# calculating the cumulative for positioning the text
manufact <- manufact %>%
arrange(desc(mfr)) %>%
mutate(y_pos = cumsum(perc)-0.38*perc)
# pie chart and bar plots
manufact %>% ggplot(aes(x="",perc, fill=mfr)) +
geom_bar(width=1,stat="identity",color="white",alpha=.5) +
coord_polar("y", start=0)+
geom_text(aes(y = y_pos, label = paste0(perc,"%")), color = "black")+
scale_fill_manual(values = rainbow(7)) +
theme_void()
# calculating the cumulative for positioning the text
manufact <- manufact %>%
arrange(desc(mfr)) %>%
mutate(y_pos = cumsum(perc)-0.36*perc)
# pie chart and bar plots
manufact %>% ggplot(aes(x="",perc, fill=mfr)) +
geom_bar(width=1,stat="identity",color="white",alpha=.5) +
coord_polar("y", start=0)+
geom_text(aes(y = y_pos, label = paste0(perc,"%")), color = "black")+
scale_fill_manual(values = rainbow(7)) +
theme_void()
# calculating the cumulative for positioning the text
manufact <- manufact %>%
arrange(desc(mfr)) %>%
mutate(y_pos = cumsum(perc)-0.37*perc)
# pie chart and bar plots
manufact %>% ggplot(aes(x="",perc, fill=mfr)) +
geom_bar(width=1,stat="identity",color="white",alpha=.5) +
coord_polar("y", start=0)+
geom_text(aes(y = y_pos, label = paste0(perc,"%")), color = "black")+
scale_fill_manual(values = rainbow(7)) +
theme_void()
# calculating the cumulative for positioning the text
manufact <- manufact %>%
arrange(desc(mfr)) %>%
mutate(y_pos = cumsum(perc)+0.37*perc)
# pie chart and bar plots
manufact %>% ggplot(aes(x="",perc, fill=mfr)) +
geom_bar(width=1,stat="identity",color="white",alpha=.5) +
coord_polar("y", start=0)+
geom_text(aes(y = y_pos, label = paste0(perc,"%")), color = "black")+
scale_fill_manual(values = rainbow(7)) +
theme_void()
# calculating the cumulative for positioning the text
manufact <- manufact %>%
arrange(desc(mfr)) %>%
mutate(y_pos = cumsum(perc)-0.4*perc)
# pie chart and bar plots
manufact %>% ggplot(aes(x="",perc, fill=mfr)) +
geom_bar(width=1,stat="identity",color="white",alpha=.5) +
coord_polar("y", start=0)+
geom_text(aes(y = y_pos, label = paste0(perc,"%")), color = "black")+
scale_fill_manual(values = rainbow(7)) +
theme_void()
# pie chart and bar plots
manufact %>% ggplot(aes(x="",perc, fill=mfr)) +
geom_bar(width=1,stat="identity",color="white",alpha=.5) +
coord_polar("y", start=0)+
geom_text(aes(y = y_pos, label = paste0(perc,"%")), color = "black")+
scale_fill_manual(values = rainbow(7)) +
theme_void() +
coord_fixed()
# pie chart and bar plots
manufact %>% ggplot(aes(x="",perc, fill=mfr)) +
geom_bar(width=1,stat="identity",color="white",alpha=.5) +
coord_polar("y", start=0)+
geom_text(aes(y = y_pos, label = paste0(perc,"%")), color = "black")+
scale_fill_manual(values = rainbow(7)) +
theme_void()
# calculating the cumulative for positioning the text
manufact <- manufact %>%
arrange(desc(mfr)) %>%
mutate(y_pos = cumsum(perc)-0.5*perc)
# pie chart and bar plots
manufact %>% ggplot(aes(x="",perc, fill=mfr)) +
geom_bar(width=1,stat="identity",color="white",alpha=.5) +
coord_polar("y", start=0)+
geom_text(aes(y = y_pos, label = paste0(perc,"%")), color = "black")+
scale_fill_manual(values = rainbow(7)) +
theme_void()
manufact %>% ggplot(aes(x="",n, fill=mfr)) +
geom_bar(stat="identity") +
coord_polar("x", start=0,direction = -1)
manufact %>% ggplot(aes(x="",perc, fill=mfr)) +
geom_bar(stat="identity") +
coord_polar("x", start=0,direction = -1)
manufact %>% ggplot(aes(x="",perc, fill=mfr)) +
geom_bar(stat="identity") +
coord_polar("x", start=0,direction = 1)
manufact %>% ggplot(aes(mfr,n, fill=mfr)) +
geom_bar(stat="identity") +
coord_polar("y", start=0,direction = -1)
manufact %>% ggplot(aes(mfr,n, fill=mfr)) +
geom_bar(stat="identity") +
coord_polar("y", start=0,direction = 1)
manufact %>% ggplot(aes(mfr,n, fill=mfr)) +
geom_bar(stat="identity") +
coord_polar("x", start=0,direction = -1)
# donut
manufact %>% ggplot(aes(x=2,percent, fill=mfr, alpha =.5)) +
geom_bar(stat="identity",color="white") +
coord_polar(theta = "y", start=0)+
geom_text(aes(y = y_pos, label = percent), color = "black")+
scale_fill_manual(values = rainbow(7)) +
theme_void() +
xlim(0.5, 2.5)
# donut
manufact %>% ggplot(aes(x=2,percent, fill=mfr, alpha =.5)) +
geom_bar(stat="identity",color="white") +
coord_polar(theta = "y", start=0)+
geom_text(aes(y = y_pos), color = "black")+
scale_fill_manual(values = rainbow(7)) +
theme_void() +
xlim(0.5, 2.5)
# donut
manufact %>% ggplot(aes(x=2,perc, fill=mfr, alpha =.5)) +
geom_bar(stat="identity",color="white") +
coord_polar(theta = "y", start=0)+
geom_text(aes(y = y_pos, label = perc), color = "black")+
scale_fill_manual(values = rainbow(7)) +
theme_void() +
xlim(0.5, 2.5)
# donut
manufact %>% ggplot(aes(x=2,perc, fill=mfr)) +
geom_bar(stat="identity",color="white", alpha =.5) +
coord_polar(theta = "y", start=0)+
geom_text(aes(y = y_pos, label = paste0(perc,"%")), color = "black")+
scale_fill_manual(values = rainbow(7)) +
theme_void() +
xlim(0.5, 2.5)
manufact[,6] <- c(8,9,6,23,22,1,8)
manufact[,6] <- c(8,9,6,23,22,1,8)
manufact[,6] <- as.data.frame(c(8,9,6,23,22,1,8))
# radial bar plot
manufact %>% arrange(n) %>% ggplot(aes(mfr,n, fill=mfr)) +
geom_bar(stat="identity") +
coord_polar("y", start=0,direction = 1)
# radial bar plot
manufact %>% arrange(desc(n)) %>% ggplot(aes(mfr,n, fill=mfr)) +
geom_bar(stat="identity") +
coord_polar("y", start=0,direction = 1)
# radial bar plot
manufact %>% ggplot(aes(x=fct_reorder(mfr, n, .desc = FALSE),n, fill=mfr)) +
geom_bar(stat="identity") +
coord_polar("y", start=0,direction = 1)
# radial bar plot
manufact %>% ggplot(aes(x=fct_reorder(mfr, perc, .desc = FALSE),n, fill=mfr)) +
geom_bar(stat="identity") +
coord_polar("y", start=0,direction = 1)
# radial bar plot
manufact %>% ggplot(aes(x=fct_reorder(mfr, perc, .desc = FALSE),n, fill=mfr)) +
geom_bar(stat="identity") +
coord_polar("y", start=0,direction = 1)+
ylim(0,25)
# radial bar plot
manufact %>% ggplot(aes(x=fct_reorder(mfr, perc, .desc = FALSE),n, fill=mfr)) +
geom_bar(stat="identity") +
coord_polar("y", start=0,direction = 1)+
ylim(0,25) + ylab("Different manufacterers") +xlab("# of different cereals")
# radial bar plot
manufact %>% ggplot(aes(x=fct_reorder(mfr, perc, .desc = FALSE),n, fill=mfr)) +
geom_bar(stat="identity") +
coord_polar("y", start=0,direction = 1)+
ylim(0,25) + xlab("Different manufacterers") +ylab("# of different cereals")
# radial bar plot
manufact %>% ggplot(aes(x=fct_reorder(mfr, perc, .desc = FALSE),n, fill=mfr)) +
geom_bar(stat="identity",alpha=0.5) +
coord_polar("y", start=0,direction = 1)+
ylim(0,25) + xlab("Different manufacterers") +ylab("# of different cereals")
# radial bar plot
manufact %>% ggplot(aes(x=fct_reorder(mfr, perc, .desc = FALSE),n, fill=mfr)) +
geom_bar(stat="identity",color=rainbow(7),alpha=0.5) +
coord_polar("y", start=0,direction = 1)+
ylim(0,25) + xlab("Different manufacterers") +ylab("# of different cereals")
# radial bar plot
manufact %>% ggplot(aes(x=fct_reorder(mfr, perc, .desc = FALSE),n, fill=mfr)) +
geom_bar(stat="identity",fill = mfr, color=rainbow(7),alpha=0.5) +
coord_polar("y", start=0,direction = 1)+
ylim(0,25) + xlab("Different manufacterers") +ylab("# of different cereals")
# radial bar plot
manufact %>% ggplot(aes(x=fct_reorder(mfr, perc, .desc = FALSE),n, fill=mfr)) +
geom_bar(stat="identity",fill =rainbow(7),alpha=0.5) +
coord_polar("y", start=0,direction = 1)+
ylim(0,25) + xlab("Different manufacterers") +ylab("# of different cereals")
# radial bar plot
manufact %>% ggplot(aes(x=fct_reorder(mfr, perc, .desc = FALSE),n)) +
geom_bar(stat="identity",fill =rainbow(7),alpha=0.5) +
coord_polar("y", start=0,direction = 1)+
ylim(0,25) + xlab("Different manufacterers") +ylab("# of different cereals")
a <- c(8,9,6,23,22,1,8)
b <- c("Q","P","N","K","G","A","R")
ab <- as.data.frame(cbind(a,b))
View(ab)
ab <- as.data.frame(cbind(b,a))
ab %>% ggplot(aes(b,a)) +
geom_point(size=5) +
geom_line() +coord_polar("x")
install.packages("fmsb")
# spider chart
library(fmsb)
data(fmsb)
?fmsb
??fmsb
fmsb
exam_scores <- data.frame(
row.names = c("Student.1", "Student.2", "Student.3"),
Biology = c(7.9, 3.9, 9.4),
Physics = c(10, 20, 0),
Maths = c(3.7, 11.5, 2.5),
Sport = c(8.7, 20, 4),
English = c(7.9, 7.2, 12.4),
Geography = c(6.4, 10.5, 6.5),
Art = c(2.4, 0.2, 9.8),
Programming = c(0, 0, 20),
Music = c(20, 20, 20)
)
exam_scores
View(exam_scores)
exam_scores %>% ggplot(aes(Biology)) +
geom_point(size=5) +
geom_line() +coord_polar("x")
ggradar(
df[1, ],
values.radar = c("0", "10", "20"),
grid.min = 0, grid.mid = 10, grid.max = 20
)
df <- exam_scores %>% rownames_to_column("group")
df
ggradar(
df[1, ],
values.radar = c("0", "10", "20"),
grid.min = 0, grid.mid = 10, grid.max = 20
)
devtools::install_github("ricardo-bion/ggradar")
library(ggradar)
ggradar(
df[1, ],
values.radar = c("0", "10", "20"),
grid.min = 0, grid.mid = 10, grid.max = 20
)
devtools::install_github("ricardo-bion/ggradar")
