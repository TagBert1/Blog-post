## Save workbook
saveWorkbook(w_book, paste0(global_final$Entity,".xlsx"))
}
for (i in 1:n_distinct(global_final$Entity_id)){
temp <- global_final %>% filter(Entity_id == i) %>% select(-c(2,7,12))
## Create a new workbook
w_book <- createWorkbook(type = "xlsx")
## Add some worksheets
createSheet(w_book, sheetName="Data")
## Save workbook
saveWorkbook(w_book, paste(global_final$Entity,".xlsx"))
}
## Save workbook
saveWorkbook(w_book, paste0(temp$Entity,".xlsx"))
## Save workbook
saveWorkbook(w_book, "a.xlsx")
for (i in 1:n_distinct(global_final$Entity_id)){
temp <- global_final %>% filter(Entity_id == i) %>% select(-c(2,7,12))
## Create a new workbook
w_book <- createWorkbook(type = "xlsx")
## Add some worksheets
createSheet(w_book, sheetName="Data")
## Save workbook
saveWorkbook(w_book, "a.xlsx")
}
View(w_book)
View(w_book)
dir <-list.dirs (path = "main", full.names = T, recursive = T)
dir
dir <-list.dirs (path = ".", full.names = T, recursive = T)
dir
dir[-1]
dir <-list.dirs (path = ".", full.names = T, recursive = T)
dir[-1]
dir <- dir[-1]
folder[1]
dir[1]
gsub("./","",dir[1])
for (j in 1:length(dir)) {
folder <- dir[i]
for (i in 1:n_distinct(global_final$Entity_id)){
temp <- global_final %>% filter(Entity_id == i & Continent == gsub("./","",folder)) %>% select(-c(2,7,12))
## Create a new workbook
w_book <- createWorkbook(type = "xlsx")
## Add some worksheets
createSheet(w_book, sheetName="Data")
## Save workbook
saveWorkbook(w_book, "a.xlsx")
}
}
for (i in 1:n_distinct(global_final$Entity_id)){
temp <- global_final %>% filter(Entity_id == i & Continent == gsub("./","",folder)) %>% select(-c(2,7,12))
## Create a new workbook
w_book <- createWorkbook(type = "xlsx")
## Add some worksheets
createSheet(w_book, sheetName="Data")
## Save workbook
saveWorkbook(w_book, file = paste0(folder,global_final$Entity,".csv"))
}
for (i in 1:n_distinct(global_final$Entity_id)){
temp <- global_final %>% filter(Entity_id == i & Continent == gsub("./","",folder)) %>% select(-c(2,7,12))
## Create a new workbook
w_book <- createWorkbook(type = "xlsx")
## Add some worksheets
createSheet(w_book, sheetName="Data")
## Save workbook
#path <- file.path(gsub(".","",folder), global_final$Entity,"-data.xlsx" )
#[1] "F:/git/roxygen2/roxygen2/README.md"
saveWorkbook(w_book, file = paste0(folder,global_final$Entity,".xlsx"))
}
for (j in 1:length(dir)) {
folder <- dir[i]
for (i in 1:n_distinct(global_final$Entity_id)){
temp <- global_final %>% filter(Entity_id == i & Continent == gsub("./","",folder)) %>% select(-c(2,7,12))
## Create a new workbook
w_book <- createWorkbook(type = "xlsx")
## Add some worksheets
createSheet(w_book, sheetName="Data")
## Save workbook
path <- file.path(gsub(".","",folder), global_final$Entity,"-data.xlsx" )
saveWorkbook(w_book, file = path)
#[1] "F:/git/roxygen2/roxygen2/README.md"
saveWorkbook(w_book, file = paste0(folder,global_final$Entity,".xlsx"))
}
}
for (j in 1:length(dir)) {
folder <- dir[i]
for (i in 1:n_distinct(global_final$Entity_id)){
temp <- global_final %>% filter(Entity_id == i & Continent == gsub("./","",folder)) %>% select(-c(2,7,12))
## Create a new workbook
w_book <- createWorkbook(type = "xlsx")
## Add some worksheets
createSheet(w_book, sheetName="Data")
## Save workbook
path <- file.path(gsub(".","",folder), global_final$Entity,"-data.xlsx" )
saveWorkbook(w_book, file = path)
#[1] "F:/git/roxygen2/roxygen2/README.md"
#saveWorkbook(w_book, file = paste0(folder,global_final$Entity,".xlsx"))
}
}
for (j in 1:length(dir)) {
folder <- dir[i]
for (i in 1:n_distinct(global_final$Entity_id)){
temp <- global_final %>% filter(Entity_id == i & Continent == gsub("./","",folder)) %>% select(-c(2,7,12))
## Create a new workbook
w_book <- createWorkbook(type = "xlsx")
## Add some worksheets
createSheet(w_book, sheetName="Data")
## Save workbook
path <- file.path(gsub(".","",folder), as.character(global_final$Entity),"-data.xlsx" )
saveWorkbook(w_book, file = path)
#[1] "F:/git/roxygen2/roxygen2/README.md"
#saveWorkbook(w_book, file = paste0(folder,global_final$Entity,".xlsx"))
}
}
for (j in 1:length(dir)) {
folder <- dir[i]
for (i in 1:n_distinct(global_final$Entity_id)){
temp <- global_final %>% filter(Entity_id == i & Continent == gsub("./","",folder)) %>% select(-c(2,7,12))
## Create a new workbook
w_book <- createWorkbook(type = "xlsx")
## Add some worksheets
createSheet(w_book, sheetName="Data")
## Save workbook
path <- file.path("C:","Users","amalasi","Documents","R","Blog post","Blog 17 - Excel 1",gsub(".","",folder), as.character(global_final$Entity),"-data.xlsx" )
saveWorkbook(w_book, file = path)
#[1] "F:/git/roxygen2/roxygen2/README.md"
#saveWorkbook(w_book, file = paste0(folder,global_final$Entity,".xlsx"))
}
}
path
for (i in 1:n_distinct(global_final$Entity_id)){
temp <- global_final %>% filter(Entity_id == i & Continent == gsub("./","",folder)) %>% select(-c(2,7,12))
## Create a new workbook
w_book <- createWorkbook(type = "xlsx")
## Add some worksheets
createSheet(w_book, sheetName="Data")
## Save workbook
path <- file.path("C:","Users","amalasi","Documents","R","Blog post","Blog 17 - Excel 1",gsub(".","",folder), paste0(as.character(global_final$Entity),"-data.xlsx"))
saveWorkbook(w_book, file = path)
#[1] "F:/git/roxygen2/roxygen2/README.md"
#saveWorkbook(w_book, file = paste0(folder,global_final$Entity,".xlsx"))
}
path
path[1]
for (j in 1:length(dir)) {
folder <- dir[i]
for (i in 1:n_distinct(global_final$Entity_id)){
temp <- global_final %>% filter(Entity_id == i) %>%
select(-c(2,7,12))
## Create a new workbook
w_book <- createWorkbook(type = "xlsx")
## Add some worksheets
createSheet(w_book, sheetName="Data")
## Save workbook
path <- file.path("C:","Users","amalasi","Documents","R","Blog post","Blog 17 - Excel 1",global_final$Continent, paste0(as.character(global_final$Entity),"-data.xlsx"))
saveWorkbook(w_book, file = path)
#[1] "F:/git/roxygen2/roxygen2/README.md"
#saveWorkbook(w_book, file = paste0(folder,global_final$Entity,".xlsx"))
}
}
path[1]
for (j in 1:length(dir)) {
folder <- dir[i]
for (i in 1:n_distinct(global_final$Entity_id)){
temp <- global_final %>% filter(Entity_id == i) %>%
select(-c(2,7,12))
## Create a new workbook
w_book <- createWorkbook(type = "xlsx")
## Add some worksheets
createSheet(w_book, sheetName="Data")
## Save workbook
#path <- file.path("C:","Users","amalasi","Documents","R","Blog post","Blog 17 - Excel 1",global_final$Continent, paste0(as.character(global_final$Entity),"-data.xlsx"))
#saveWorkbook(w_book, file = path)
#[1] "F:/git/roxygen2/roxygen2/README.md"
saveWorkbook(w_book, file = paste0(global_final$Continent,"/",global_final$Entity,".xlsx"))
}
}
for (j in 1:length(dir)) {
folder <- dir[i]
for (i in 1:n_distinct(global_final$Entity_id)){
temp <- global_final %>% filter(Entity_id == i) %>%
select(-c(2,7,12))
## Create a new workbook
w_book <- createWorkbook(type = "xlsx")
## Add some worksheets
createSheet(w_book, sheetName="Data")
## Save workbook
path <- file.path("C:","Users","amalasi","Documents","R","Blog post","Blog 17 - Excel 1",global_final$Continent, paste0(as.character(global_final$Entity),"-data.xlsx"))
saveWorkbook(w_book, file = path)
#[1] "F:/git/roxygen2/roxygen2/README.md"
#saveWorkbook(w_book, file = paste0(global_final$Continent,"/",global_final$Entity,".xlsx"))
}
}
for (j in 1:length(dir)) {
folder <- dir[i]
for (i in 1:n_distinct(global_final$Entity_id)){
temp <- global_final %>% filter(Entity_id == i) %>%
select(-c(2,7,12))
## Create a new workbook
w_book <- createWorkbook(type = "xlsx")
## Add some worksheets
createSheet(w_book, sheetName="Data")
## Save workbook
path <- file.path("C:","Users","amalasi","Documents","R","Blog post","Blog 17 - Excel 1",global_final$Continent, paste0(as.character(global_final$Entity),"-data.xlsx"))
saveWorkbook(list(w_book), file = path)
#[1] "F:/git/roxygen2/roxygen2/README.md"
#saveWorkbook(w_book, file = paste0(global_final$Continent,"/",global_final$Entity,".xlsx"))
}
}
for (j in 1:length(dir)) {
folder <- dir[i]
for (i in 1:n_distinct(global_final$Entity_id)){
temp <- global_final %>% filter(Entity_id == i) %>%
select(-c(2,7,12))
## Create a new workbook
w_book <- createWorkbook(type = "xlsx")
## Add some worksheets
createSheet(w_book, sheetName="Data")
## Save workbook
path <- file.path("C:","Users","amalasi","Documents","R","Blog post","Blog 17 - Excel 1",global_final$Continent, paste0(as.character(global_final$Entity),"-data.xlsx"))
saveWorkbook(w_book, file = path)
#[1] "F:/git/roxygen2/roxygen2/README.md"
saveWorkbook(w_book, paste0(paste(global_final$Continent,"/",sep = ""),global_final$Entity,".xlsx"))
}
}
for (i in 1:n_distinct(global_final$Entity_id)){
temp <- global_final %>% filter(Entity_id == i) %>%
select(-c(2,7,12))
## Create a new workbook
w_book <- createWorkbook(type = "xlsx")
## Add some worksheets
createSheet(w_book, sheetName="Data")
## Save workbook
#path <- file.path("C:","Users","amalasi","Documents","R","Blog post","Blog 17 - Excel 1",global_final$Continent, paste0(as.character(global_final$Entity),"-data.xlsx"))
#saveWorkbook(w_book, file = path)
#[1] "F:/git/roxygen2/roxygen2/README.md"
saveWorkbook(w_book, paste0(paste(global_final$Continent,"/",sep = ""),global_final$Entity,".xlsx"))
}
for (j in 1:length(split_sheet)){
assign(paste("global_split_",j, sep = ""),
read.xlsx2("global-data.xlsx", sheetIndex=j,
as.data.frame=TRUE, header=TRUE))
# write.xlsx(data[[i]], file="global-split.xlsx")
}
global_split_1 <-mutate_all(global_split_1, list(~na_if(.,"")))
global_split_1 <- global_split_1 %>% group_by(Entity,Code) %>%
fill(Continent, .direction = "downup") %>%
ungroup()
global_final <- merge(x = global_split_1[,-1], y = global_split_2[,-1], by = c("Entity","Code","Year"), all = TRUE)
global_final <- merge(x = global_final, y = global_split_3[,-1], by = c("Entity","Code","Year"), all = TRUE)
conti <- unique(global_final$Continent)
for (i in 1:n_distinct(global_final$Continent)) {
dir.create(conti[i])
}
# Create a numeric id for countries
global_final <- global_final[-1,]
global_final$Entity_id = as.numeric(as.factor(global_final$Entity))
# extracting folders info
dir <-list.dirs (path = ".", full.names = T, recursive = T)
dir <- dir[-1]
for (j in 1:length(dir)) {
folder <- dir[i]
for (i in 1:n_distinct(global_final$Entity_id)){
temp <- global_final %>% filter(Entity_id == i) %>%
select(-c(2,7,12))
## Create a new workbook
w_book <- createWorkbook(type = "xlsx")
## Add some worksheets
createSheet(w_book, sheetName="Data")
## Save workbook
#path <- file.path("C:","Users","amalasi","Documents","R","Blog post","Blog 17 - Excel 1",global_final$Continent, paste0(as.character(global_final$Entity),"-data.xlsx"))
#saveWorkbook(w_book, file = path)
#[1] "F:/git/roxygen2/roxygen2/README.md"
saveWorkbook(w_book, paste0(paste(global_final$Continent,"/"),global_final$Entity,".xlsx"))
}
}
for (i in 1:n_distinct(global_final$Entity_id)){
temp <- global_final %>% filter(Entity_id == i) %>%
select(-c(2,7,12))
## Create a new workbook
w_book <- createWorkbook(type = "xlsx")
## Add some worksheets
new_sheet <- createSheet(w_book, sheetName="Data")
addDataFrame(temp, new_sheet, startRow=1, startColumn=1)
## Save workbook
#path <- file.path("C:","Users","amalasi","Documents","R","Blog post","Blog 17 - Excel 1",global_final$Continent, paste0(as.character(global_final$Entity),"-data.xlsx"))
#saveWorkbook(w_book, file = path)
#[1] "F:/git/roxygen2/roxygen2/README.md"
saveWorkbook(w_book, paste0(paste(global_final$Continent,"/"),global_final$Entity,".xlsx"))
}
#[1] "F:/git/roxygen2/roxygen2/README.md"
saveWorkbook(w_book, paste0(paste0(global_final$Continent,"/"),global_final$Entity,".xlsx"))
for (j in 1:length(dir)) {
folder <- dir[i]
for (i in 1:n_distinct(global_final$Entity_id)){
temp <- global_final %>% filter(Entity_id == i) %>%
select(-c(2,7,12))
## Create a new workbook
w_book <- createWorkbook(type = "xlsx")
## Add some worksheets
new_sheet <- createSheet(w_book, sheetName="Data")
addDataFrame(temp, new_sheet, startRow=1, startColumn=1)
## Save workbook
#path <- file.path("C:","Users","amalasi","Documents","R","Blog post","Blog 17 - Excel 1",global_final$Continent, paste0(as.character(global_final$Entity),"-data.xlsx"))
#saveWorkbook(w_book, file = path)
#[1] "F:/git/roxygen2/roxygen2/README.md"
saveWorkbook(w_book, paste0(paste0(global_final$Continent,"/"),global_final$Entity,".xlsx"))
}
}
for (j in 1:length(dir)) {
folder <- dir[i]
for (i in 1:n_distinct(global_final$Entity_id)){
temp <- global_final %>% filter(Entity_id == i) %>%
select(-c(2,7,12))
## Create a new workbook
w_book <- createWorkbook(type = "xlsx")
## Add some worksheets
new_sheet <- createSheet(w_book, sheetName="Data")
addDataFrame(temp, new_sheet, startRow=1, startColumn=1)
## Save workbook
#path <- file.path("C:","Users","amalasi","Documents","R","Blog post","Blog 17 - Excel 1",global_final$Continent, paste0(as.character(global_final$Entity),"-data.xlsx"))
#saveWorkbook(w_book, file = path)
#[1] "F:/git/roxygen2/roxygen2/README.md"
saveWorkbook(w_book, paste0(global_final$Entity,".xlsx"))
}
}
for (i in 1:n_distinct(global_final$Entity_id)){
temp <- global_final %>% filter(Entity_id == i) %>%
select(-c(2,7,12))
## Create a new workbook
w_book <- createWorkbook(type = "xlsx")
## Add some worksheets
createSheet(w_book, sheetName="Data")
#addDataFrame(temp, new_sheet, startRow=1, startColumn=1)
## Save workbook
#path <- file.path("C:","Users","amalasi","Documents","R","Blog post","Blog 17 - Excel 1",global_final$Continent, paste0(as.character(global_final$Entity),"-data.xlsx"))
#saveWorkbook(w_book, file = path)
#[1] "F:/git/roxygen2/roxygen2/README.md"
saveWorkbook(w_book, paste0(global_final$Entity_id,".xlsx"))
}
#[1] "F:/git/roxygen2/roxygen2/README.md"
saveWorkbook(w_book, paste0(i,".xlsx"))
for (j in 1:length(dir)) {
folder <- dir[i]
for (i in 1:n_distinct(global_final$Entity_id)){
temp <- global_final %>% filter(Entity_id == i) %>%
select(-c(2,7,12))
## Create a new workbook
w_book <- createWorkbook(type = "xlsx")
## Add some worksheets
createSheet(w_book, sheetName="Data")
#addDataFrame(temp, new_sheet, startRow=1, startColumn=1)
## Save workbook
#path <- file.path("C:","Users","amalasi","Documents","R","Blog post","Blog 17 - Excel 1",global_final$Continent, paste0(as.character(global_final$Entity),"-data.xlsx"))
#saveWorkbook(w_book, file = path)
#[1] "F:/git/roxygen2/roxygen2/README.md"
saveWorkbook(w_book, paste0(i,".xlsx"))
}
}
for (j in 1:length(dir)) {
folder <- dir[i]
for (i in 1:n_distinct(global_final$Entity_id)){
temp <- global_final %>% filter(Entity_id == i) %>%
select(-c(2,7,12))
## Create a new workbook
w_book <- createWorkbook(type = "xlsx")
## Add some worksheets
new_sheet <- createSheet(w_book, sheetName="Data")
addDataFrame(temp, new_sheet, startRow=1, startColumn=1)
## Save workbook
#path <- file.path("C:","Users","amalasi","Documents","R","Blog post","Blog 17 - Excel 1",global_final$Continent, paste0(as.character(global_final$Entity),"-data.xlsx"))
#saveWorkbook(w_book, file = path)
#[1] "F:/git/roxygen2/roxygen2/README.md"
saveWorkbook(w_book, paste0(global_final$Continent,"/",global_final$Entity,".xlsx"))
}
}
for (j in 1:length(dir)) {
folder <- dir[i]
for (i in 1:n_distinct(global_final$Entity_id)){
temp <- global_final %>% filter(Entity_id == i) %>%
select(-c(2,7,12))
## Create a new workbook
w_book <- createWorkbook(type = "xlsx")
## Add some worksheets
new_sheet <- createSheet(w_book, sheetName="Data")
addDataFrame(temp, new_sheet, startRow=1, startColumn=1)
## Save workbook
#path <- file.path("C:","Users","amalasi","Documents","R","Blog post","Blog 17 - Excel 1",global_final$Continent, paste0(as.character(global_final$Entity),"-data.xlsx"))
#saveWorkbook(w_book, file = path)
#[1] "F:/git/roxygen2/roxygen2/README.md"
#saveWorkbook(w_book, paste0(global_final$Continent,"/",global_final$Entity,".xlsx"))
global_final$Entity
}
}
for (j in 1:length(dir)) {
folder <- dir[i]
for (i in 1:n_distinct(global_final$Entity_id)){
temp <- global_final %>% filter(Entity_id == i) %>%
select(-c(2,7,12))
## Create a new workbook
w_book <- createWorkbook(type = "xlsx")
## Add some worksheets
new_sheet <- createSheet(w_book, sheetName="Data")
addDataFrame(temp, new_sheet, startRow=1, startColumn=1)
## Save workbook
#path <- file.path("C:","Users","amalasi","Documents","R","Blog post","Blog 17 - Excel 1",global_final$Continent, paste0(as.character(global_final$Entity),"-data.xlsx"))
#saveWorkbook(w_book, file = path)
#[1] "F:/git/roxygen2/roxygen2/README.md"
#saveWorkbook(w_book, paste0(global_final$Continent,"/",global_final$Entity,".xlsx"))
saveWorkbook(w_book, paste0(i,".xlsx"))
}
}
for (j in 1:length(dir)) {
folder <- dir[i]
for (i in 1:n_distinct(global_final$Entity_id)){
temp <- global_final %>% filter(Entity_id == i) %>%
select(-c(2,7,12))
## Create a new workbook
w_book <- createWorkbook(type = "xlsx")
## Add some worksheets
new_sheet <- createSheet(w_book, sheetName="Data")
addDataFrame(temp, new_sheet, startRow=1, startColumn=1)
## Save workbook
#path <- file.path("C:","Users","amalasi","Documents","R","Blog post","Blog 17 - Excel 1",global_final$Continent, paste0(as.character(global_final$Entity),"-data.xlsx"))
#saveWorkbook(w_book, file = path)
#[1] "F:/git/roxygen2/roxygen2/README.md"
#saveWorkbook(w_book, paste0(global_final$Continent,"/",global_final$Entity,".xlsx"))
saveWorkbook(w_book, paste0(i,".xlsx"))
}
}
max(col(global_final$Entry_id))
(col(global_final$Entry_id))
which(grepl(7, global_final$Entity_id))
max(which(grepl(7, global_final$Entity_id)))
global_final$Continent[7]
for (j in 1:length(dir)) {
folder <- dir[i]
for (i in 1:n_distinct(global_final$Entity_id)){
temp <- global_final %>% filter(Entity_id == i) %>%
select(-c(2,7,12))
## Create a new workbook
w_book <- createWorkbook(type = "xlsx")
## Add some worksheets
new_sheet <- createSheet(w_book, sheetName="Data")
addDataFrame(temp, new_sheet, startRow=1, startColumn=1)
## Save workbook
#path <- file.path("C:","Users","amalasi","Documents","R","Blog post","Blog 17 - Excel 1",global_final$Continent, paste0(as.character(global_final$Entity),"-data.xlsx"))
#saveWorkbook(w_book, file = path)
#[1] "F:/git/roxygen2/roxygen2/README.md"
#saveWorkbook(w_book, paste0(global_final$Continent,"/",global_final$Entity,".xlsx"))
#saveWorkbook(w_book, paste0(i,".xlsx"))
id <- max(which(grepl(i, global_final$Entity_id)))
saveWorkbook(w_book, paste0(global_final$Continent[i],"/",global_final$Entity[i],".xlsx"))
}
}
n_distinct(global_final$Entity_id)
View(global_final)
global_final$Entity_id = as.numeric(as.factor(global_final$Entity))
for (i in 1:n_distinct(global_final$Entity_id)){
temp <- global_final %>% filter(Entity_id == i) %>%
select(-c(2,7,12))
## Create a new workbook
w_book <- createWorkbook(type = "xlsx")
## Add some worksheets
new_sheet <- createSheet(w_book, sheetName="Data")
addDataFrame(temp, new_sheet, startRow=1, startColumn=1)
## Save workbook
#path <- file.path("C:","Users","amalasi","Documents","R","Blog post","Blog 17 - Excel 1",global_final$Continent, paste0(as.character(global_final$Entity),"-data.xlsx"))
#saveWorkbook(w_book, file = path)
#[1] "F:/git/roxygen2/roxygen2/README.md"
#saveWorkbook(w_book, paste0(global_final$Continent,"/",global_final$Entity,".xlsx"))
#saveWorkbook(w_book, paste0(i,".xlsx"))
id <- max(which(grepl(i, global_final$Entity_id)))
saveWorkbook(w_book, paste0(global_final$Continent[i],"/",global_final$Entity[i],".xlsx"))
}
for (i in 1:n_distinct(global_final$Entity_id)){
temp <- global_final %>% filter(Entity_id == i) %>%
select(-c(2,7,12))
## Create a new workbook
w_book <- createWorkbook(type = "xlsx")
## Add some worksheets
new_sheet <- createSheet(w_book, sheetName="Data")
addDataFrame(temp, new_sheet, startRow=1, startColumn=1)
## Save workbook
#path <- file.path("C:","Users","amalasi","Documents","R","Blog post","Blog 17 - Excel 1",global_final$Continent, paste0(as.character(global_final$Entity),"-data.xlsx"))
#saveWorkbook(w_book, file = path)
#[1] "F:/git/roxygen2/roxygen2/README.md"
#saveWorkbook(w_book, paste0(global_final$Continent,"/",global_final$Entity,".xlsx"))
#saveWorkbook(w_book, paste0(i,".xlsx"))
id <- (which(grepl(i, global_final$Entity_id)))
saveWorkbook(w_book, paste0(global_final$Continent[i],"/",global_final$Entity[i],".xlsx"))
}
id <- (which(grepl(103, global_final$Entity_id)))
id
for (i in 1:n_distinct(global_final$Entity_id)){
temp <- global_final %>% filter(Entity_id == i) %>%
select(-c(2,7,12))
## Create a new workbook
w_book <- createWorkbook(type = "xlsx")
## Add some worksheets
new_sheet <- createSheet(w_book, sheetName="Data")
addDataFrame(temp, new_sheet, startRow=1, startColumn=1)
## Save workbook
#path <- file.path("C:","Users","amalasi","Documents","R","Blog post","Blog 17 - Excel 1",global_final$Continent, paste0(as.character(global_final$Entity),"-data.xlsx"))
#saveWorkbook(w_book, file = path)
#[1] "F:/git/roxygen2/roxygen2/README.md"
#saveWorkbook(w_book, paste0(global_final$Continent,"/",global_final$Entity,".xlsx"))
#saveWorkbook(w_book, paste0(i,".xlsx"))
id <- max(which(grepl(i, global_final$Entity_id)))
saveWorkbook(w_book, paste0(global_final$Continent[id],"/",global_final$Entity[id],".xlsx"))
}
